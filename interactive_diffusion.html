<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Diffusion Coefficient Calculator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.1.3/es5/tex-mml-chtml.js">
  </script>
  <style>
    .MathJax {
      z-index: 101 !important;
    }
  </style>
</head>
<body>
  <div class="container mt-5">
    <h1>Diffusion Coefficient Calculator</h1>

    <h3>Viscosity of Glycerol Solutions at 20˚C (no salinity) (Takamura et al., 2012. Table 10. 'Physical properties of aqueous glycerol solutions')</h3>
    <table class="table table-bordered table-striped" style="width: auto; margin: auto;">
      <thead>
        <tr>
          <th>Solvent</th>
          <th>Viscosity (centiPoise)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>H2O</td>
          <td>1.04</td>
        </tr>
        <tr>
          <td>20% glycerol (w/w)</td>
          <td>1.84</td>
        </tr>
        <tr>
          <td>40% glycerol (w/w)</td>
          <td>3.63</td>
        </tr>
        <tr>
          <td>60% glycerol (w/w)</td>
          <td>11.67</td>
        </tr>
        <tr>
          <td>78% glycerol (w/w)</td>
          <td>48.79</td>
        </tr>
        <tr>
          <td>91% glycerol (w/w)</td>
          <td>220.52</td>
        </tr>
      </tbody>
    </table>

    <form id="calculator-form">
      <div class="mb-3">
        <label for="temperature" class="form-label">Temperature (°C)</label>
        <input type="number" class="form-control" id="temperature" value="20">
      </div>
      <div class="mb-3">
        <label for="viscosity" class="form-label">Viscosity (mPa·s) or centiPoise</label>
        <input type="number" class="form-control" id="viscosity" step="any", value="1.04">
      </div>
      <div class="mb-3">
        <label for="frameInterval" class="form-label">Frame Interval (s)</label>
        <input type="number" class="form-control" id="frameInterval" step="any" value="0.05">
      </div>
      <div class="mb-3">
        <label for="pixelValue" class="form-label">Pixel Value (micron/pixel)</label>
        <input type="number" class="form-control" id="pixelValue" step="any" value="0.157">
      </div>
      <div class="mb-3">
        <label for="diameter" class="form-label">Particle Diameter (nm)</label>
        <input type="number" class="form-control" id="diameter" step="any" value="40">
      </div>
      <button type="submit" class="btn btn-primary">Calculate</button>
    </form>
    <div class="mt-3">
      <strong>Diffusion Coefficient:</strong> <span id="result"></span> \( \mu m^2/s \)
    </div>
    <div class="mt-3">
      <strong>Average Distance:</strong> <span id="avgDistance"></span> \( \mu m \)
    </div>
    <div class="mt-3">
      <strong>Average Distance in Pixels:</strong> <span id="avgDistancePixel"></span> \( \text{pixels} \)
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const form = document.getElementById("calculator-form");
      form.addEventListener("submit", function(e) {
        e.preventDefault();
        const T = parseFloat(document.getElementById("temperature").value) + 273.15; // Convert to Kelvin
        const eta = parseFloat(document.getElementById("viscosity").value) * 1e-3; // Convert to kg/m/s
        const d = parseFloat(document.getElementById("diameter").value) * 1e-9; // Convert to meters
        const kB = 1.380649e-23; // Boltzmann constant in m^2 kg s^-2 K^-1
        
        let D = (kB * T) / (3 * Math.PI * eta * d);
        D *= 1e12;

        let frameInterval = parseFloat(document.getElementById("frameInterval").value); // Frame interval in seconds
        let pixelValue = parseFloat(document.getElementById("pixelValue").value); // Micron/pixel

        let avgDistance = Math.sqrt(D * frameInterval); // Average distance in micron
        let avgDistancePixel = avgDistance / pixelValue; // Average distance in pixels

        document.getElementById("result").textContent = D.toFixed(3);
        document.getElementById("avgDistance").textContent = avgDistance.toFixed(3);
        document.getElementById("avgDistancePixel").textContent = avgDistancePixel.toFixed(3);

        // Trigger MathJax to re-render equations
        MathJax.typeset();
      });
    });
  </script>
</body>
</html>
